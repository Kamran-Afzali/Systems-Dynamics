<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Memory Matters: Introduction to Delay Differential Equations | Systems Dynamics</title>
  <meta name="description" content="Chapter 10 Memory Matters: Introduction to Delay Differential Equations | Systems Dynamics" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Memory Matters: Introduction to Delay Differential Equations | Systems Dynamics" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/EHRVAL.jpg" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Memory Matters: Introduction to Delay Differential Equations | Systems Dynamics" />
  
  
  <meta name="twitter:image" content="/EHRVAL.jpg" />

<meta name="author" content="Kamran Afzali" />


<meta name="date" content="2025-12-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Systems Dynamics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Differential Equations and Systems Dynamics</a></li>
<li class="chapter" data-level="2" data-path="why-the-world-changes-an-introduction-to-differential-equations.html"><a href="why-the-world-changes-an-introduction-to-differential-equations.html"><i class="fa fa-check"></i><b>2</b> Why the World Changes: An Introduction to Differential Equations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="why-the-world-changes-an-introduction-to-differential-equations.html"><a href="why-the-world-changes-an-introduction-to-differential-equations.html#the-language-of-change"><i class="fa fa-check"></i><b>2.1</b> The Language of Change</a></li>
<li class="chapter" data-level="2.2" data-path="why-the-world-changes-an-introduction-to-differential-equations.html"><a href="why-the-world-changes-an-introduction-to-differential-equations.html#from-coffee-to-cosmos"><i class="fa fa-check"></i><b>2.2</b> From Coffee to Cosmos</a></li>
<li class="chapter" data-level="2.3" data-path="why-the-world-changes-an-introduction-to-differential-equations.html"><a href="why-the-world-changes-an-introduction-to-differential-equations.html#getting-our-hands-dirty-solving-a-simple-example"><i class="fa fa-check"></i><b>2.3</b> Getting Our Hands Dirty: Solving a Simple Example</a></li>
<li class="chapter" data-level="2.4" data-path="why-the-world-changes-an-introduction-to-differential-equations.html"><a href="why-the-world-changes-an-introduction-to-differential-equations.html#seeing-the-solution-in-action"><i class="fa fa-check"></i><b>2.4</b> Seeing the Solution in Action</a></li>
<li class="chapter" data-level="2.5" data-path="why-the-world-changes-an-introduction-to-differential-equations.html"><a href="why-the-world-changes-an-introduction-to-differential-equations.html#when-theory-meets-reality"><i class="fa fa-check"></i><b>2.5</b> When Theory Meets Reality</a></li>
<li class="chapter" data-level="2.6" data-path="why-the-world-changes-an-introduction-to-differential-equations.html"><a href="why-the-world-changes-an-introduction-to-differential-equations.html#the-bigger-picture"><i class="fa fa-check"></i><b>2.6</b> The Bigger Picture</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html"><i class="fa fa-check"></i><b>3</b> Solving Simple Differential Equations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html#the-art-of-separation"><i class="fa fa-check"></i><b>3.1</b> The Art of Separation</a></li>
<li class="chapter" data-level="3.2" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html#finding-the-missing-piece"><i class="fa fa-check"></i><b>3.2</b> Finding the Missing Piece</a></li>
<li class="chapter" data-level="3.3" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html#the-method-in-action"><i class="fa fa-check"></i><b>3.3</b> The Method in Action</a></li>
<li class="chapter" data-level="3.4" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html#beyond-simple-cooling-the-exponential-family"><i class="fa fa-check"></i><b>3.4</b> Beyond Simple Cooling: The Exponential Family</a></li>
<li class="chapter" data-level="3.5" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html#when-variables-refuse-to-separate"><i class="fa fa-check"></i><b>3.5</b> When Variables Refuse to Separate</a></li>
<li class="chapter" data-level="3.6" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html#a-more-complex-example-mixing-problems"><i class="fa fa-check"></i><b>3.6</b> A More Complex Example: Mixing Problems</a></li>
<li class="chapter" data-level="3.7" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html#the-power-and-limits-of-separation"><i class="fa fa-check"></i><b>3.7</b> The Power and Limits of Separation</a></li>
<li class="chapter" data-level="3.8" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html#building-intuition"><i class="fa fa-check"></i><b>3.8</b> Building Intuition</a></li>
<li class="chapter" data-level="3.9" data-path="solving-simple-differential-equations.html"><a href="solving-simple-differential-equations.html#whats-next"><i class="fa fa-check"></i><b>3.9</b> What’s Next</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html"><i class="fa fa-check"></i><b>4</b> Nonlinear Dynamics in One Dimension</a>
<ul>
<li class="chapter" data-level="4.1" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html#when-more-becomes-different"><i class="fa fa-check"></i><b>4.1</b> When More Becomes Different</a></li>
<li class="chapter" data-level="4.2" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html#finding-the-balance-points"><i class="fa fa-check"></i><b>4.2</b> Finding the Balance Points</a></li>
<li class="chapter" data-level="4.3" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html#the-logistic-portrait"><i class="fa fa-check"></i><b>4.3</b> The Logistic Portrait</a></li>
<li class="chapter" data-level="4.4" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html#beyond-simple-equilibrium-bistable-systems"><i class="fa fa-check"></i><b>4.4</b> Beyond Simple Equilibrium: Bistable Systems</a></li>
<li class="chapter" data-level="4.5" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html#the-geometry-of-dynamics"><i class="fa fa-check"></i><b>4.5</b> The Geometry of Dynamics</a></li>
<li class="chapter" data-level="4.6" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html#harvesting-and-catastrophic-collapse"><i class="fa fa-check"></i><b>4.6</b> Harvesting and Catastrophic Collapse</a></li>
<li class="chapter" data-level="4.7" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html#the-richness-of-one-dimension"><i class="fa fa-check"></i><b>4.7</b> The Richness of One Dimension</a></li>
<li class="chapter" data-level="4.8" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html#building-intuition-for-the-nonlinear-world"><i class="fa fa-check"></i><b>4.8</b> Building Intuition for the Nonlinear World</a></li>
<li class="chapter" data-level="4.9" data-path="nonlinear-dynamics-in-one-dimension.html"><a href="nonlinear-dynamics-in-one-dimension.html#the-path-forward"><i class="fa fa-check"></i><b>4.9</b> The Path Forward</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><i class="fa fa-check"></i><b>5</b> The Phase Line of One-Dimensional Dynamics: A Healthcare Perspective</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#the-geometry-of-flow"><i class="fa fa-check"></i><b>5.1</b> The Geometry of Flow</a></li>
<li class="chapter" data-level="5.2" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#the-universal-patterns-of-creation-and-annihilation"><i class="fa fa-check"></i><b>5.2</b> The Universal Patterns of Creation and Annihilation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#the-saddle-node-bifurcation-threshold-phenomena"><i class="fa fa-check"></i><b>5.2.1</b> The Saddle-Node Bifurcation: Threshold Phenomena</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#the-pitchfork-bifurcation-symmetry-breaking"><i class="fa fa-check"></i><b>5.2.2</b> The Pitchfork Bifurcation: Symmetry Breaking</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#the-bifurcation-diagram-mapping-parameter-space"><i class="fa fa-check"></i><b>5.3</b> The Bifurcation Diagram: Mapping Parameter Space</a></li>
<li class="chapter" data-level="5.4" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#hysteresis-and-system-memory"><i class="fa fa-check"></i><b>5.4</b> Hysteresis and System Memory</a></li>
<li class="chapter" data-level="5.5" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#beyond-classical-bifurcations-transcritical-transitions"><i class="fa fa-check"></i><b>5.5</b> Beyond Classical Bifurcations: Transcritical Transitions</a></li>
<li class="chapter" data-level="5.6" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#cusp-catastrophes-and-multiple-parameter-systems"><i class="fa fa-check"></i><b>5.6</b> Cusp Catastrophes and Multiple Parameter Systems</a></li>
<li class="chapter" data-level="5.7" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#imperfect-bifurcations-and-structural-stability"><i class="fa fa-check"></i><b>5.7</b> Imperfect Bifurcations and Structural Stability</a></li>
<li class="chapter" data-level="5.8" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#the-landscape-perspective"><i class="fa fa-check"></i><b>5.8</b> The Landscape Perspective</a></li>
<li class="chapter" data-level="5.9" data-path="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html"><a href="the-phase-line-of-one-dimensional-dynamics-a-healthcare-perspective.html#building-toward-higher-dimensions"><i class="fa fa-check"></i><b>5.9</b> Building Toward Higher Dimensions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html"><i class="fa fa-check"></i><b>6</b> Introducion to Systems</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#the-architecture-of-coupled-systems"><i class="fa fa-check"></i><b>6.1</b> The Architecture of Coupled Systems</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#fixed-points-and-local-stability-analysis"><i class="fa fa-check"></i><b>6.1.1</b> Fixed Points and Local Stability Analysis</a></li>
<li class="chapter" data-level="6.1.2" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#the-phase-portrait-visualizing-global-behavior"><i class="fa fa-check"></i><b>6.1.2</b> The Phase Portrait: Visualizing Global Behavior</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#beyond-simple-oscillations-modified-predator-prey-systems"><i class="fa fa-check"></i><b>6.2</b> Beyond Simple Oscillations: Modified Predator-Prey Systems</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#competitive-systems-and-exclusion-principles"><i class="fa fa-check"></i><b>6.2.1</b> Competitive Systems and Exclusion Principles</a></li>
<li class="chapter" data-level="6.2.2" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#nullclines-and-phase-plane-analysis"><i class="fa fa-check"></i><b>6.2.2</b> Nullclines and Phase Plane Analysis</a></li>
<li class="chapter" data-level="6.2.3" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#the-geometry-of-stability"><i class="fa fa-check"></i><b>6.2.3</b> The Geometry of Stability</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#time-series-and-oscillatory-dynamics"><i class="fa fa-check"></i><b>6.3</b> Time Series and Oscillatory Dynamics</a></li>
<li class="chapter" data-level="6.4" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#basins-of-attraction-and-global-dynamics"><i class="fa fa-check"></i><b>6.4</b> Basins of Attraction and Global Dynamics</a></li>
<li class="chapter" data-level="6.5" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#the-road-to-chaos-nonlinear-feedback-and-complex-dynamics"><i class="fa fa-check"></i><b>6.5</b> The Road to Chaos: Nonlinear Feedback and Complex Dynamics</a></li>
<li class="chapter" data-level="6.6" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#limit-cycles-and-oscillatory-attractors"><i class="fa fa-check"></i><b>6.6</b> Limit Cycles and Oscillatory Attractors</a></li>
<li class="chapter" data-level="6.7" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#applications-across-disciplines"><i class="fa fa-check"></i><b>6.7</b> Applications Across Disciplines</a></li>
<li class="chapter" data-level="6.8" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#bifurcations-in-two-dimensional-systems"><i class="fa fa-check"></i><b>6.8</b> Bifurcations in Two-Dimensional Systems</a></li>
<li class="chapter" data-level="6.9" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#the-geometric-foundation-of-complexity"><i class="fa fa-check"></i><b>6.9</b> The Geometric Foundation of Complexity</a></li>
<li class="chapter" data-level="6.10" data-path="introducion-to-systems.html"><a href="introducion-to-systems.html#beyond-two-dimensions-preparing-for-chaos"><i class="fa fa-check"></i><b>6.10</b> Beyond Two Dimensions: Preparing for Chaos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="immune-system-dynamics-an-example.html"><a href="immune-system-dynamics-an-example.html"><i class="fa fa-check"></i><b>7</b> Immune System Dynamics: An Example</a>
<ul>
<li class="chapter" data-level="7.1" data-path="immune-system-dynamics-an-example.html"><a href="immune-system-dynamics-an-example.html#fixed-points-and-the-geography-of-infection-outcomes"><i class="fa fa-check"></i><b>7.1</b> Fixed Points and the Geography of Infection Outcomes</a></li>
<li class="chapter" data-level="7.2" data-path="immune-system-dynamics-an-example.html"><a href="immune-system-dynamics-an-example.html#phase-portrait-mapping-infection-trajectories"><i class="fa fa-check"></i><b>7.2</b> Phase Portrait: Mapping Infection Trajectories</a></li>
<li class="chapter" data-level="7.3" data-path="immune-system-dynamics-an-example.html"><a href="immune-system-dynamics-an-example.html#temporal-dynamics-the-clinical-course-of-infection"><i class="fa fa-check"></i><b>7.3</b> Temporal Dynamics: The Clinical Course of Infection</a></li>
<li class="chapter" data-level="7.4" data-path="immune-system-dynamics-an-example.html"><a href="immune-system-dynamics-an-example.html#treatment-intervention-timing-windows"><i class="fa fa-check"></i><b>7.4</b> Treatment Intervention: Timing Windows</a></li>
<li class="chapter" data-level="7.5" data-path="immune-system-dynamics-an-example.html"><a href="immune-system-dynamics-an-example.html#periodic-reactivation-dynamics"><i class="fa fa-check"></i><b>7.5</b> Periodic Reactivation Dynamics</a></li>
<li class="chapter" data-level="7.6" data-path="immune-system-dynamics-an-example.html"><a href="immune-system-dynamics-an-example.html#bifurcations-parameter-thresholds-and-disease-transitions"><i class="fa fa-check"></i><b>7.6</b> Bifurcations: Parameter Thresholds and Disease Transitions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html"><i class="fa fa-check"></i><b>8</b> Finding Balance: Equilibrium Points and Linear Stability</a>
<ul>
<li class="chapter" data-level="8.1" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html#the-nature-of-equilibrium"><i class="fa fa-check"></i><b>8.1</b> The Nature of Equilibrium</a></li>
<li class="chapter" data-level="8.2" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html#linear-approximation-and-the-jacobian-matrix"><i class="fa fa-check"></i><b>8.2</b> Linear Approximation and the Jacobian Matrix</a></li>
<li class="chapter" data-level="8.3" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html#eigenvalue-analysis-and-stability-classification"><i class="fa fa-check"></i><b>8.3</b> Eigenvalue Analysis and Stability Classification</a></li>
<li class="chapter" data-level="8.4" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html#the-taxonomy-of-fixed-points"><i class="fa fa-check"></i><b>8.4</b> The Taxonomy of Fixed Points</a></li>
<li class="chapter" data-level="8.5" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html#application-to-epidemic-dynamics"><i class="fa fa-check"></i><b>8.5</b> Application to Epidemic Dynamics</a></li>
<li class="chapter" data-level="8.6" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html#timescale-separation-and-dominant-dynamics"><i class="fa fa-check"></i><b>8.6</b> Timescale Separation and Dominant Dynamics</a></li>
<li class="chapter" data-level="8.7" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html#nonhyperbolic-fixed-points-and-structural-stability"><i class="fa fa-check"></i><b>8.7</b> Nonhyperbolic Fixed Points and Structural Stability</a></li>
<li class="chapter" data-level="8.8" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html#the-dance-of-feedback-understanding-system-response"><i class="fa fa-check"></i><b>8.8</b> The Dance of Feedback: Understanding System Response</a></li>
<li class="chapter" data-level="8.9" data-path="finding-balance-equilibrium-points-and-linear-stability.html"><a href="finding-balance-equilibrium-points-and-linear-stability.html#conclusion-the-local-global-connection"><i class="fa fa-check"></i><b>8.9</b> Conclusion: The Local-Global Connection</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><i class="fa fa-check"></i><b>9</b> Spirals, Cycles, and Chaos: Complex Behaviors in 2D Systems</a>
<ul>
<li class="chapter" data-level="9.1" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#the-poincaré-bendixson-theorem-and-the-topology-of-two-dimensions"><i class="fa fa-check"></i><b>9.1</b> The Poincaré-Bendixson Theorem and the Topology of Two Dimensions</a></li>
<li class="chapter" data-level="9.2" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#limit-cycles-self-sustained-oscillations"><i class="fa fa-check"></i><b>9.2</b> Limit Cycles: Self-Sustained Oscillations</a></li>
<li class="chapter" data-level="9.3" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#stability-of-limit-cycles-and-floquet-theory"><i class="fa fa-check"></i><b>9.3</b> Stability of Limit Cycles and Floquet Theory</a></li>
<li class="chapter" data-level="9.4" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#hopf-bifurcations-the-birth-of-oscillations"><i class="fa fa-check"></i><b>9.4</b> Hopf Bifurcations: The Birth of Oscillations</a></li>
<li class="chapter" data-level="9.5" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#multiple-time-scales-and-relaxation-oscillations"><i class="fa fa-check"></i><b>9.5</b> Multiple Time Scales and Relaxation Oscillations</a></li>
<li class="chapter" data-level="9.6" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#disease-states-as-dynamical-transitions"><i class="fa fa-check"></i><b>9.6</b> Disease States as Dynamical Transitions</a></li>
<li class="chapter" data-level="9.7" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#sensitive-dependence-and-the-seeds-of-chaos"><i class="fa fa-check"></i><b>9.7</b> Sensitive Dependence and the Seeds of Chaos</a></li>
<li class="chapter" data-level="9.8" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#the-boundary-between-order-and-chaos"><i class="fa fa-check"></i><b>9.8</b> The Boundary Between Order and Chaos</a></li>
<li class="chapter" data-level="9.9" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#clinical-implications-and-therapeutic-interventions"><i class="fa fa-check"></i><b>9.9</b> Clinical Implications and Therapeutic Interventions</a></li>
<li class="chapter" data-level="9.10" data-path="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html"><a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html#beyond-two-dimensions-the-gateway-to-chaos"><i class="fa fa-check"></i><b>9.10</b> Beyond Two Dimensions: The Gateway to Chaos</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="memory-matters-introduction-to-delay-differential-equations.html"><a href="memory-matters-introduction-to-delay-differential-equations.html"><i class="fa fa-check"></i><b>10</b> Memory Matters: Introduction to Delay Differential Equations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="memory-matters-introduction-to-delay-differential-equations.html"><a href="memory-matters-introduction-to-delay-differential-equations.html#the-mathematical-structure-of-delay-systems"><i class="fa fa-check"></i><b>10.1</b> The Mathematical Structure of Delay Systems</a></li>
<li class="chapter" data-level="10.2" data-path="memory-matters-introduction-to-delay-differential-equations.html"><a href="memory-matters-introduction-to-delay-differential-equations.html#stability-analysis-and-characteristic-equations"><i class="fa fa-check"></i><b>10.2</b> Stability Analysis and Characteristic Equations</a></li>
<li class="chapter" data-level="10.3" data-path="memory-matters-introduction-to-delay-differential-equations.html"><a href="memory-matters-introduction-to-delay-differential-equations.html#numerical-implementation"><i class="fa fa-check"></i><b>10.3</b> Numerical Implementation</a></li>
<li class="chapter" data-level="10.4" data-path="memory-matters-introduction-to-delay-differential-equations.html"><a href="memory-matters-introduction-to-delay-differential-equations.html#population-dynamics-with-maturation-delays"><i class="fa fa-check"></i><b>10.4</b> Population Dynamics with Maturation Delays</a></li>
<li class="chapter" data-level="10.5" data-path="memory-matters-introduction-to-delay-differential-equations.html"><a href="memory-matters-introduction-to-delay-differential-equations.html#medical-applications-infectious-disease-with-latency"><i class="fa fa-check"></i><b>10.5</b> Medical Applications: Infectious Disease with Latency</a></li>
<li class="chapter" data-level="10.6" data-path="memory-matters-introduction-to-delay-differential-equations.html"><a href="memory-matters-introduction-to-delay-differential-equations.html#drug-pharmacokinetics-and-treatment-delays"><i class="fa fa-check"></i><b>10.6</b> Drug Pharmacokinetics and Treatment Delays</a></li>
<li class="chapter" data-level="10.7" data-path="memory-matters-introduction-to-delay-differential-equations.html"><a href="memory-matters-introduction-to-delay-differential-equations.html#immunological-memory-and-delayed-response"><i class="fa fa-check"></i><b>10.7</b> Immunological Memory and Delayed Response</a></li>
<li class="chapter" data-level="10.8" data-path="memory-matters-introduction-to-delay-differential-equations.html"><a href="memory-matters-introduction-to-delay-differential-equations.html#connecting-past-and-future"><i class="fa fa-check"></i><b>10.8</b> Connecting Past and Future</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Systems Dynamics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="memory-matters-introduction-to-delay-differential-equations" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Memory Matters: Introduction to Delay Differential Equations<a href="memory-matters-introduction-to-delay-differential-equations.html#memory-matters-introduction-to-delay-differential-equations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The assumptions we make when modeling systems often reveal more about our limitations than about reality itself. Throughout our exploration of dynamical systems, we have implicitly assumed something profoundly unrealistic: that systems respond instantaneously to their current state. A predator encounters prey and immediately converts that meal into offspring. A disease spreads through contact with infected individuals who become infectious the moment they’re exposed. An immune system detects a pathogen and mounts an instantaneous response.</p>
<p>Nature, of course, operates differently. Biological processes unfold over time. Rabbits don’t reproduce the instant they consume grass—gestation takes weeks. Viral infections don’t render hosts infectious immediately—incubation periods can span days or weeks. Drug treatments don’t act instantaneously—pharmacokinetics involves absorption, distribution, metabolism, and elimination, each with characteristic timescales. These time delays fundamentally alter system dynamics, introducing memory effects that can destabilize stable equilibria, create oscillations where none existed before, and generate complex behaviors impossible in systems governed by ordinary differential equations.</p>
<p>Delay differential equations (DDEs) incorporate these memory effects explicitly, allowing a system’s rate of change to depend not only on its current state but also on its past states. This seemingly modest extension—replacing <span class="math inline">\(f(x(t))\)</span> with <span class="math inline">\(f(x(t), x(t-\tau))\)</span>—transforms our mathematical framework in profound ways. The system’s state space becomes infinite-dimensional, requiring specification of entire history functions as initial conditions. Stability analysis involves transcendental characteristic equations with infinitely many roots. Bifurcations can occur as delays increase, transforming stable steady states into oscillatory dynamics through mechanisms impossible in ordinary differential equations.</p>
<p>Consider the simplest possible example—a scalar linear delay equation with negative feedback:</p>
<p><span class="math display">\[\frac{dx}{dt} = -ax(t) - bx(t-\tau)\]</span></p>
<p>Here, <span class="math inline">\(x(t)\)</span> represents some quantity (population size, hormone concentration, economic indicator), <span class="math inline">\(a &gt; 0\)</span> governs instantaneous decay, <span class="math inline">\(b &gt; 0\)</span> represents the strength of the <strong>delayed negative feedback</strong>, and <span class="math inline">\(\tau &gt; 0\)</span> represents the time delay. Despite its apparent simplicity, this equation exhibits remarkably rich behavior. For small delays, the system behaves much like its ordinary differential equation counterpart, with solutions converging to equilibrium. As the delay increases beyond a critical threshold, however, the equilibrium can lose stability, spawning sustained oscillations. The delay transforms a simple damped system into an oscillator—memory creates dynamics.</p>
<div id="the-mathematical-structure-of-delay-systems" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> The Mathematical Structure of Delay Systems<a href="memory-matters-introduction-to-delay-differential-equations.html#the-mathematical-structure-of-delay-systems" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A general autonomous delay differential equation takes the form:</p>
<p><span class="math display">\[\frac{dx}{dt} = f(x(t), x(t-\tau_1), x(t-\tau_2), \ldots, x(t-\tau_n))\]</span></p>
<p>where <span class="math inline">\(x(t) \in \mathbb{R}^d\)</span> represents the system state and <span class="math inline">\(\tau_i &gt; 0\)</span> denote discrete time delays. The function <span class="math inline">\(f\)</span> can depend on the current state and any number of past states at specific time lags. More generally, systems can involve distributed delays where the entire history influences dynamics:</p>
<p><span class="math display">\[\frac{dx}{dt} = f\left(x(t), \int_{-\infty}^{t} K(t-s)x(s)ds\right)\]</span></p>
<p>Here, the kernel function <span class="math inline">\(K(t-s)\)</span> weights contributions from different points in the past, representing situations where recent history matters most but distant past still exerts some influence.</p>
<p>The fundamental challenge posed by delay differential equations stems from their initial conditions. Unlike ordinary differential equations requiring only the state at time <span class="math inline">\(t=0\)</span>, delay equations require specification of the system’s history over an entire interval. For a delay <span class="math inline">\(\tau\)</span>, we must specify <span class="math inline">\(x(t)\)</span> for all <span class="math inline">\(t \in [-\tau, 0]\)</span>—an initial function or history function <span class="math inline">\(\phi(t)\)</span> rather than a single initial value. This transforms the phase space from finite-dimensional <span class="math inline">\(\mathbb{R}^d\)</span> to infinite-dimensional function spaces, fundamentally altering the mathematical landscape.</p>
<p>Despite this complexity, delay equations preserve crucial properties of ordinary differential equations. Solutions exist and are unique given continuous initial functions and sufficiently well-behaved right-hand sides. Trajectories evolve continuously, and the system’s behavior for <span class="math inline">\(t &gt; 0\)</span> is completely determined by the initial history.</p>
</div>
<div id="stability-analysis-and-characteristic-equations" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Stability Analysis and Characteristic Equations<a href="memory-matters-introduction-to-delay-differential-equations.html#stability-analysis-and-characteristic-equations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider a delay differential equation with a fixed point <span class="math inline">\(x^*\)</span> satisfying <span class="math inline">\(f(x^*, x^*, \ldots, x^*) = 0\)</span>. To analyze stability, we linearize around this equilibrium. For the scalar equation with negative feedback defined above:</p>
<p><span class="math display">\[\frac{dy}{dt} = -ay(t) - by(t-\tau)\]</span></p>
<p>We seek solutions of the form <span class="math inline">\(y(t) = e^{\lambda t}\)</span>, substituting into the equation:</p>
<p><span class="math display">\[\lambda e^{\lambda t} = -ae^{\lambda t} - be^{\lambda(t-\tau)} = -ae^{\lambda t} - be^{\lambda t}e^{-\lambda\tau}\]</span></p>
<p>Dividing by <span class="math inline">\(e^{\lambda t}\)</span> yields the characteristic equation:</p>
<p><span class="math display">\[\lambda = -a - be^{-\lambda\tau}\]</span></p>
<p>or equivalently:</p>
<p><span class="math display">\[\lambda + a + be^{-\lambda\tau} = 0\]</span></p>
<p>This transcendental equation possesses infinitely many complex roots <span class="math inline">\(\lambda_k\)</span>. The equilibrium is stable if all roots satisfy <span class="math inline">\(\text{Re}(\lambda_k) &lt; 0\)</span>.</p>
<p>For the case <span class="math inline">\(a = 0\)</span> (pure delayed negative feedback), the characteristic equation becomes <span class="math inline">\(\lambda + be^{-\lambda\tau} = 0\)</span>. This equation reveals how delays affect stability. There exists a critical delay <span class="math inline">\(\tau_c\)</span> beyond which the equilibrium destabilizes. As <span class="math inline">\(\tau\)</span> increases through <span class="math inline">\(\tau_c\)</span>, a pair of complex conjugate roots crosses the imaginary axis, triggering a Hopf bifurcation that creates periodic oscillations.</p>
<p>The critical delay can be found by setting <span class="math inline">\(\lambda = i\omega\)</span> (purely imaginary) and solving:</p>
<p><span class="math display">\[i\omega = -be^{-i\omega\tau} = -b(\cos(-\omega\tau) + i\sin(-\omega\tau))\]</span>
<span class="math display">\[i\omega = -b\cos(\omega\tau) + ib\sin(\omega\tau)\]</span></p>
<p>Equating real and imaginary parts:
1. <span class="math inline">\(0 = -b\cos(\omega\tau) \implies \omega\tau = \pi/2\)</span> (since <span class="math inline">\(\cos(\theta)=0\)</span> at <span class="math inline">\(\pi/2\)</span>)
2. <span class="math inline">\(\omega = b\sin(\omega\tau) \implies \omega = b\)</span> (since <span class="math inline">\(\sin(\pi/2)=1\)</span>)</p>
<p>Thus, the oscillation frequency is <span class="math inline">\(\omega = b\)</span>, and the critical delay is:</p>
<p><span class="math display">\[\tau_c = \frac{\pi}{2b}\]</span></p>
<p>This critical delay threshold represents a fundamental property of delayed negative feedback systems: sufficiently large delays destabilize negative feedback, converting damped responses into sustained oscillations.</p>
</div>
<div id="numerical-implementation" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Numerical Implementation<a href="memory-matters-introduction-to-delay-differential-equations.html#numerical-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will implement this using the <code>deSolve</code> package in R. Note that for proper DDE solving, we must correctly handle the history (time <span class="math inline">\(t \leq 0\)</span>) and ensure the feedback term allows for instability (negative feedback).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb1-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb1-2"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb1-3"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-1" tabindex="-1"></a><span class="co"># Scalar linear delay equation: dx/dt = -ax(t) - bx(t-tau)</span></span>
<span id="cb5-2"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-2" tabindex="-1"></a><span class="co"># Note the NEGATIVE sign on the delayed term to create negative feedback</span></span>
<span id="cb5-3"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-3" tabindex="-1"></a>linear_dde <span class="ot">&lt;-</span> <span class="cf">function</span>(t, y, parms) {</span>
<span id="cb5-4"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-4" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(parms), {</span>
<span id="cb5-5"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-5" tabindex="-1"></a>    </span>
<span id="cb5-6"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-6" tabindex="-1"></a>    <span class="co"># Access lag values</span></span>
<span id="cb5-7"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-7" tabindex="-1"></a>    <span class="co"># If t &lt; tau, lagvalue returns the initial history (assumed constant y0 here)</span></span>
<span id="cb5-8"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-8" tabindex="-1"></a>    <span class="cf">if</span> (t <span class="sc">&lt;=</span> tau) {</span>
<span id="cb5-9"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-9" tabindex="-1"></a>      lag_y <span class="ot">&lt;-</span> y <span class="co"># Simplified: assumes constant history equal to initial y</span></span>
<span id="cb5-10"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-10" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb5-11"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-11" tabindex="-1"></a>      lag_y <span class="ot">&lt;-</span> <span class="fu">lagvalue</span>(t <span class="sc">-</span> tau)</span>
<span id="cb5-12"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-12" tabindex="-1"></a>    }</span>
<span id="cb5-13"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-13" tabindex="-1"></a>    </span>
<span id="cb5-14"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-14" tabindex="-1"></a>    <span class="co"># Equation: Negative Feedback</span></span>
<span id="cb5-15"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-15" tabindex="-1"></a>    dy <span class="ot">&lt;-</span> <span class="sc">-</span>a <span class="sc">*</span> y <span class="sc">-</span> b <span class="sc">*</span> lag_y</span>
<span id="cb5-16"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-16" tabindex="-1"></a>    <span class="fu">list</span>(dy)</span>
<span id="cb5-17"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-17" tabindex="-1"></a>  })</span>
<span id="cb5-18"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-18" tabindex="-1"></a>}</span>
<span id="cb5-19"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-19" tabindex="-1"></a></span>
<span id="cb5-20"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-20" tabindex="-1"></a><span class="co"># Parameters for stability analysis</span></span>
<span id="cb5-21"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-21" tabindex="-1"></a><span class="co"># We fix &#39;b&#39; (feedback strength) and vary &#39;tau&#39;</span></span>
<span id="cb5-22"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-22" tabindex="-1"></a><span class="co"># Critical delay is roughly pi/(2*b) ~= 1.96</span></span>
<span id="cb5-23"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-23" tabindex="-1"></a>params_stable <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fl">0.1</span>, <span class="at">b =</span> <span class="fl">0.8</span>, <span class="at">tau =</span> <span class="fl">1.0</span>)</span>
<span id="cb5-24"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-24" tabindex="-1"></a>params_unstable <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="fl">0.1</span>, <span class="at">b =</span> <span class="fl">0.8</span>, <span class="at">tau =</span> <span class="fl">3.5</span>)</span>
<span id="cb5-25"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-25" tabindex="-1"></a></span>
<span id="cb5-26"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-26" tabindex="-1"></a><span class="co"># Time points</span></span>
<span id="cb5-27"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-27" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb5-28"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-28" tabindex="-1"></a></span>
<span id="cb5-29"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-29" tabindex="-1"></a><span class="co"># Solve stable case</span></span>
<span id="cb5-30"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-30" tabindex="-1"></a>sol_stable <span class="ot">&lt;-</span> <span class="fu">dede</span>(<span class="at">y =</span> <span class="fl">1.0</span>, </span>
<span id="cb5-31"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-31" tabindex="-1"></a>                   <span class="at">times =</span> times, </span>
<span id="cb5-32"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-32" tabindex="-1"></a>                   <span class="at">func =</span> linear_dde, </span>
<span id="cb5-33"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-33" tabindex="-1"></a>                   <span class="at">parms =</span> params_stable)</span>
<span id="cb5-34"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-34" tabindex="-1"></a></span>
<span id="cb5-35"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-35" tabindex="-1"></a><span class="co"># Solve unstable case</span></span>
<span id="cb5-36"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-36" tabindex="-1"></a>sol_unstable <span class="ot">&lt;-</span> <span class="fu">dede</span>(<span class="at">y =</span> <span class="fl">1.0</span>, </span>
<span id="cb5-37"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-37" tabindex="-1"></a>                     <span class="at">times =</span> times, </span>
<span id="cb5-38"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-38" tabindex="-1"></a>                     <span class="at">func =</span> linear_dde,</span>
<span id="cb5-39"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-39" tabindex="-1"></a>                     <span class="at">parms =</span> params_unstable)</span>
<span id="cb5-40"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-40" tabindex="-1"></a></span>
<span id="cb5-41"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-41" tabindex="-1"></a><span class="co"># Create comparison plot</span></span>
<span id="cb5-42"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-42" tabindex="-1"></a>df_stable <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> sol_stable[,<span class="dv">1</span>], <span class="at">value =</span> sol_stable[,<span class="dv">2</span>], </span>
<span id="cb5-43"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-43" tabindex="-1"></a>                        <span class="at">case =</span> <span class="st">&quot;Small Delay (Stable)&quot;</span>)</span>
<span id="cb5-44"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-44" tabindex="-1"></a>df_unstable <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> sol_unstable[,<span class="dv">1</span>], <span class="at">value =</span> sol_unstable[,<span class="dv">2</span>],</span>
<span id="cb5-45"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-45" tabindex="-1"></a>                          <span class="at">case =</span> <span class="st">&quot;Large Delay (Unstable)&quot;</span>)</span>
<span id="cb5-46"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-46" tabindex="-1"></a>df_combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_stable, df_unstable)</span>
<span id="cb5-47"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-47" tabindex="-1"></a></span>
<span id="cb5-48"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-48" tabindex="-1"></a>delay_comparison_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_combined, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, <span class="at">color =</span> case)) <span class="sc">+</span></span>
<span id="cb5-49"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-49" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-50"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-50" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-51"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-51" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Small Delay (Stable)&quot;</span> <span class="ot">=</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb5-52"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-52" tabindex="-1"></a>                                <span class="st">&quot;Large Delay (Unstable)&quot;</span> <span class="ot">=</span> <span class="st">&quot;coral&quot;</span>)) <span class="sc">+</span></span>
<span id="cb5-53"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-53" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Effect of Time Delay on Stability&quot;</span>,</span>
<span id="cb5-54"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-54" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Same negative feedback strength, different delays&quot;</span>,</span>
<span id="cb5-55"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-55" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">y =</span> <span class="st">&quot;System State&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-56"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-56" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-57"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb5-57" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb7-1" tabindex="-1"></a><span class="fu">print</span>(delay_comparison_plot)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>The visualization reveals the dramatic effect of delay magnitude. With small delays, perturbations decay monotonically to equilibrium. With larger delays, the same system oscillates with growing amplitude, eventually settling into sustained periodic motion (or diverging if not bounded by non-linearities).</p>
</div>
<div id="population-dynamics-with-maturation-delays" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Population Dynamics with Maturation Delays<a href="memory-matters-introduction-to-delay-differential-equations.html#population-dynamics-with-maturation-delays" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ecological systems provide natural contexts for delay differential equations. A classic model is the Hutchinson-Wright equation (also known as the delayed logistic equation). Unlike models that separate birth and death naively, this formulation applies the delay specifically to the density-dependent regulatory term.</p>
<p><span class="math display">\[\frac{dN}{dt} = rN(t)\left(1 - \frac{N(t-\tau)}{K}\right)\]</span></p>
<p>Here, <span class="math inline">\(N(t)\)</span> represents population density, <span class="math inline">\(r\)</span> denotes the intrinsic growth rate, <span class="math inline">\(K\)</span> represents carrying capacity, and <span class="math inline">\(\tau\)</span> is the maturation delay. The term <span class="math inline">\((1 - N(t-\tau)/K)\)</span> represents the regulatory feedback: resources consumed <span class="math inline">\(\tau\)</span> time units ago determine the current growth capacity. This formulation correctly combines birth and death processes into a net growth rate, avoiding biologically impossible “negative birth rates” while preserving the oscillatory dynamics caused by delayed resource limitation.</p>
<p>This equation exhibits profoundly different behavior than the ordinary logistic equation. For small delays, the carrying capacity remains a stable equilibrium. As the delay increases, this equilibrium can destabilize through a Hopf bifurcation, creating sustained population cycles—a phenomenon observed in nature, such as in blowfly populations or lemming cycles.</p>
</div>
<div id="medical-applications-infectious-disease-with-latency" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Medical Applications: Infectious Disease with Latency<a href="memory-matters-introduction-to-delay-differential-equations.html#medical-applications-infectious-disease-with-latency" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Infectious disease dynamics provide compelling applications of delay differential equations. Most diseases involve a latent period—the time between infection and becoming infectious. To model this rigorously without violating mass conservation, we must account for the individuals currently in the “latent” phase (often denoted <span class="math inline">\(E\)</span>).</p>
<p>A consistent DDE formulation for an SIR model with latency is:</p>
<p><span class="math display">\[\frac{dS}{dt} = -\beta S(t)I(t)\]</span>
<span class="math display">\[\frac{dI}{dt} = \beta S(t-\tau)I(t-\tau)e^{-\mu\tau} - \gamma I(t)\]</span>
<span class="math display">\[\frac{dR}{dt} = \gamma I(t)\]</span></p>
<p>Here, the inflow to the Infectious class <span class="math inline">\(I\)</span> at time <span class="math inline">\(t\)</span> corresponds exactly to the outflow from the Susceptible class <span class="math inline">\(S\)</span> at time <span class="math inline">\(t-\tau\)</span>, multiplied by the survival probability <span class="math inline">\(e^{-\mu\tau}\)</span> (where <span class="math inline">\(\mu\)</span> is natural mortality). This ensures that individuals don’t just “vanish”—those who left <span class="math inline">\(S\)</span> but haven’t yet entered <span class="math inline">\(I\)</span> are implicitly in the latent (Exposed) stage.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-1" tabindex="-1"></a><span class="co"># SIR model with latent period (SEIR reduced to DDE)</span></span>
<span id="cb8-2"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-2" tabindex="-1"></a>sir_delay <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb8-3"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-3" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb8-4"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-4" tabindex="-1"></a>    </span>
<span id="cb8-5"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-5" tabindex="-1"></a>    <span class="co"># To conserve mass in the math, we track S and I history</span></span>
<span id="cb8-6"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-6" tabindex="-1"></a>    <span class="cf">if</span> (t <span class="sc">&lt;=</span> tau) {</span>
<span id="cb8-7"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-7" tabindex="-1"></a>       <span class="co"># Initial history</span></span>
<span id="cb8-8"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-8" tabindex="-1"></a>       lag_S <span class="ot">&lt;-</span> S0</span>
<span id="cb8-9"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-9" tabindex="-1"></a>       lag_I <span class="ot">&lt;-</span> I0</span>
<span id="cb8-10"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-10" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb8-11"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-11" tabindex="-1"></a>       lag_state <span class="ot">&lt;-</span> <span class="fu">lagvalue</span>(t <span class="sc">-</span> tau)</span>
<span id="cb8-12"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-12" tabindex="-1"></a>       lag_S <span class="ot">&lt;-</span> lag_state[<span class="dv">1</span>]</span>
<span id="cb8-13"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-13" tabindex="-1"></a>       lag_I <span class="ot">&lt;-</span> lag_state[<span class="dv">2</span>]</span>
<span id="cb8-14"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-14" tabindex="-1"></a>    }</span>
<span id="cb8-15"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-15" tabindex="-1"></a>    </span>
<span id="cb8-16"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-16" tabindex="-1"></a>    <span class="co"># Current infection events</span></span>
<span id="cb8-17"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-17" tabindex="-1"></a>    new_infections_current <span class="ot">&lt;-</span> beta <span class="sc">*</span> S <span class="sc">*</span> I</span>
<span id="cb8-18"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-18" tabindex="-1"></a>    </span>
<span id="cb8-19"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-19" tabindex="-1"></a>    <span class="co"># Delayed entry into Infectious class (recruitment from latent phase)</span></span>
<span id="cb8-20"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-20" tabindex="-1"></a>    <span class="co"># This matches the S outflow from tau ago</span></span>
<span id="cb8-21"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-21" tabindex="-1"></a>    new_infectious_delayed <span class="ot">&lt;-</span> beta <span class="sc">*</span> lag_S <span class="sc">*</span> lag_I <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>mu <span class="sc">*</span> tau)</span>
<span id="cb8-22"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-22" tabindex="-1"></a>    </span>
<span id="cb8-23"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-23" tabindex="-1"></a>    <span class="co"># Derivatives</span></span>
<span id="cb8-24"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-24" tabindex="-1"></a>    dS <span class="ot">&lt;-</span> <span class="sc">-</span>new_infections_current</span>
<span id="cb8-25"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-25" tabindex="-1"></a>    dI <span class="ot">&lt;-</span> new_infectious_delayed <span class="sc">-</span> gamma <span class="sc">*</span> I</span>
<span id="cb8-26"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-26" tabindex="-1"></a>    dR <span class="ot">&lt;-</span> gamma <span class="sc">*</span> I</span>
<span id="cb8-27"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-27" tabindex="-1"></a>    </span>
<span id="cb8-28"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-28" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">c</span>(dS, dI, dR))</span>
<span id="cb8-29"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-29" tabindex="-1"></a>  })</span>
<span id="cb8-30"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-30" tabindex="-1"></a>}</span>
<span id="cb8-31"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-31" tabindex="-1"></a></span>
<span id="cb8-32"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-32" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb8-33"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-33" tabindex="-1"></a>params_disease <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb8-34"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-34" tabindex="-1"></a>  <span class="at">beta =</span> <span class="fl">0.5</span>,      </span>
<span id="cb8-35"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-35" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fl">0.2</span>,     </span>
<span id="cb8-36"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-36" tabindex="-1"></a>  <span class="at">mu =</span> <span class="fl">0.0001</span>,     </span>
<span id="cb8-37"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-37" tabindex="-1"></a>  <span class="at">tau =</span> <span class="dv">2</span>,         </span>
<span id="cb8-38"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-38" tabindex="-1"></a>  <span class="at">S0 =</span> <span class="fl">0.99</span>,       </span>
<span id="cb8-39"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-39" tabindex="-1"></a>  <span class="at">I0 =</span> <span class="fl">0.01</span>        </span>
<span id="cb8-40"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-40" tabindex="-1"></a>)</span>
<span id="cb8-41"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-41" tabindex="-1"></a></span>
<span id="cb8-42"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-42" tabindex="-1"></a><span class="co"># Initial conditions</span></span>
<span id="cb8-43"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-43" tabindex="-1"></a>initial_state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">S =</span> params_disease<span class="sc">$</span>S0, <span class="at">I =</span> params_disease<span class="sc">$</span>I0, <span class="at">R =</span> <span class="dv">0</span>)</span>
<span id="cb8-44"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-44" tabindex="-1"></a></span>
<span id="cb8-45"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-45" tabindex="-1"></a><span class="co"># Time span</span></span>
<span id="cb8-46"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-46" tabindex="-1"></a>times_disease <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb8-47"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-47" tabindex="-1"></a></span>
<span id="cb8-48"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-48" tabindex="-1"></a><span class="co"># Solve SIR with delay</span></span>
<span id="cb8-49"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-49" tabindex="-1"></a>sol_sir_delay <span class="ot">&lt;-</span> <span class="fu">dede</span>(<span class="at">y =</span> initial_state, </span>
<span id="cb8-50"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-50" tabindex="-1"></a>                      <span class="at">times =</span> times_disease, </span>
<span id="cb8-51"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-51" tabindex="-1"></a>                      <span class="at">func =</span> sir_delay, </span>
<span id="cb8-52"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-52" tabindex="-1"></a>                      <span class="at">parms =</span> params_disease)</span>
<span id="cb8-53"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-53" tabindex="-1"></a></span>
<span id="cb8-54"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-54" tabindex="-1"></a><span class="co"># Convert to data frame</span></span>
<span id="cb8-55"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-55" tabindex="-1"></a>df_sir <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sol_sir_delay)</span>
<span id="cb8-56"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-56" tabindex="-1"></a><span class="fu">colnames</span>(df_sir) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;R&quot;</span>)</span>
<span id="cb8-57"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-57" tabindex="-1"></a></span>
<span id="cb8-58"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-58" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb8-59"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-59" tabindex="-1"></a>df_sir_long <span class="ot">&lt;-</span> df_sir <span class="sc">%&gt;%</span></span>
<span id="cb8-60"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-60" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(S, I, R), <span class="at">names_to =</span> <span class="st">&quot;compartment&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;proportion&quot;</span>)</span>
<span id="cb8-61"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-61" tabindex="-1"></a></span>
<span id="cb8-62"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-62" tabindex="-1"></a>epidemic_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_sir_long, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> proportion, <span class="at">color =</span> compartment)) <span class="sc">+</span></span>
<span id="cb8-63"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-63" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb8-64"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-64" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span> <span class="ot">=</span> <span class="st">&quot;steelblue&quot;</span>, <span class="st">&quot;I&quot;</span> <span class="ot">=</span> <span class="st">&quot;coral&quot;</span>, <span class="st">&quot;R&quot;</span> <span class="ot">=</span> <span class="st">&quot;darkgreen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb8-65"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-65" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Epidemic Dynamics with Latent Period&quot;</span>,</span>
<span id="cb8-66"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-66" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Implicit &#39;Exposed&#39; population exists between S drop and I rise&quot;</span>,</span>
<span id="cb8-67"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-67" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time (days)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Proportion&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Compartment&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-68"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-68" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb8-69"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-69" tabindex="-1"></a></span>
<span id="cb8-70"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb8-70" tabindex="-1"></a><span class="fu">print</span>(epidemic_plot)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The epidemic curve reveals that the sum <span class="math inline">\(S+I+R\)</span> is not constant (it is slightly less than 1), representing the fraction of the population currently in the latent period (Exposed) at any given time.</p>
</div>
<div id="drug-pharmacokinetics-and-treatment-delays" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Drug Pharmacokinetics and Treatment Delays<a href="memory-matters-introduction-to-delay-differential-equations.html#drug-pharmacokinetics-and-treatment-delays" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pharmaceutical interventions involve inherent delays. In numerical simulations, handling repeated dosing requires care. Simple “if” statements inside differential equations can be skipped by adaptive solvers. The robust method is to use an “events” dataset that forces the solver to add the dose at specific times.</p>
<p>Consider a model where a drug is added to a depot <span class="math inline">\(A\)</span> (gut), absorbed with a delay <span class="math inline">\(\tau\)</span> into the central compartment <span class="math inline">\(C\)</span>, and eliminated.</p>
<p><span class="math display">\[\frac{dA}{dt} = - k_a A(t)\]</span>
<span class="math display">\[\frac{dC}{dt} = \frac{k_a A(t-\tau)}{V} - k_e C(t)\]</span></p>
<p>Dosing is handled as discrete events where <span class="math inline">\(A(t)\)</span> increases instantaneously by the dose amount.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-1" tabindex="-1"></a><span class="co"># Pharmacokinetic model with absorption delay</span></span>
<span id="cb9-2"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-2" tabindex="-1"></a>pk_delay <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb9-3"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-3" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb9-4"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-4" tabindex="-1"></a>    </span>
<span id="cb9-5"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-5" tabindex="-1"></a>    <span class="co"># Delayed absorption from Depot (A)</span></span>
<span id="cb9-6"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-6" tabindex="-1"></a>    <span class="cf">if</span> (t <span class="sc">&lt;=</span> tau) {</span>
<span id="cb9-7"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-7" tabindex="-1"></a>      lag_A <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-8"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-8" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb9-9"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-9" tabindex="-1"></a>      lag_state <span class="ot">&lt;-</span> <span class="fu">lagvalue</span>(t <span class="sc">-</span> tau)</span>
<span id="cb9-10"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-10" tabindex="-1"></a>      lag_A <span class="ot">&lt;-</span> lag_state[<span class="dv">1</span>]</span>
<span id="cb9-11"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-11" tabindex="-1"></a>    }</span>
<span id="cb9-12"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-12" tabindex="-1"></a>    </span>
<span id="cb9-13"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-13" tabindex="-1"></a>    <span class="co"># Derivatives</span></span>
<span id="cb9-14"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-14" tabindex="-1"></a>    dA <span class="ot">&lt;-</span> <span class="sc">-</span>ka <span class="sc">*</span> A</span>
<span id="cb9-15"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-15" tabindex="-1"></a>    dC <span class="ot">&lt;-</span> (ka <span class="sc">*</span> lag_A <span class="sc">/</span> V) <span class="sc">-</span> ke <span class="sc">*</span> C</span>
<span id="cb9-16"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-16" tabindex="-1"></a>    </span>
<span id="cb9-17"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-17" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">c</span>(dA, dC))</span>
<span id="cb9-18"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-18" tabindex="-1"></a>  })</span>
<span id="cb9-19"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-19" tabindex="-1"></a>}</span>
<span id="cb9-20"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-20" tabindex="-1"></a></span>
<span id="cb9-21"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-21" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb9-22"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-22" tabindex="-1"></a>params_pk <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb9-23"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-23" tabindex="-1"></a>  <span class="at">ka =</span> <span class="fl">1.5</span>,              <span class="co"># Absorption rate (1/hour)</span></span>
<span id="cb9-24"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-24" tabindex="-1"></a>  <span class="at">ke =</span> <span class="fl">0.3</span>,              <span class="co"># Elimination rate (1/hour)</span></span>
<span id="cb9-25"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-25" tabindex="-1"></a>  <span class="at">V =</span> <span class="dv">50</span>,                <span class="co"># Volume of distribution (L)</span></span>
<span id="cb9-26"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-26" tabindex="-1"></a>  <span class="at">tau =</span> <span class="fl">2.0</span>              <span class="co"># Absorption delay (hours)</span></span>
<span id="cb9-27"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-27" tabindex="-1"></a>)</span>
<span id="cb9-28"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-28" tabindex="-1"></a></span>
<span id="cb9-29"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-29" tabindex="-1"></a><span class="co"># Dosing Events: 500mg every 8 hours for 9 doses</span></span>
<span id="cb9-30"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-30" tabindex="-1"></a>dosing_times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">64</span>, <span class="at">by =</span> <span class="dv">8</span>)</span>
<span id="cb9-31"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-31" tabindex="-1"></a>dose_events <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var =</span> <span class="st">&quot;A&quot;</span>, </span>
<span id="cb9-32"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-32" tabindex="-1"></a>                          <span class="at">time =</span> dosing_times, </span>
<span id="cb9-33"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-33" tabindex="-1"></a>                          <span class="at">value =</span> <span class="dv">500</span>, </span>
<span id="cb9-34"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-34" tabindex="-1"></a>                          <span class="at">method =</span> <span class="st">&quot;add&quot;</span>)</span>
<span id="cb9-35"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-35" tabindex="-1"></a></span>
<span id="cb9-36"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-36" tabindex="-1"></a><span class="co"># Initial conditions</span></span>
<span id="cb9-37"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-37" tabindex="-1"></a>initial_pk <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">A =</span> <span class="dv">0</span>, <span class="at">C =</span> <span class="dv">0</span>)</span>
<span id="cb9-38"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-38" tabindex="-1"></a>times_pk <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">72</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb9-39"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-39" tabindex="-1"></a></span>
<span id="cb9-40"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-40" tabindex="-1"></a><span class="co"># Solve with events</span></span>
<span id="cb9-41"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-41" tabindex="-1"></a>sol_pk <span class="ot">&lt;-</span> <span class="fu">dede</span>(<span class="at">y =</span> initial_pk, </span>
<span id="cb9-42"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-42" tabindex="-1"></a>               <span class="at">times =</span> times_pk, </span>
<span id="cb9-43"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-43" tabindex="-1"></a>               <span class="at">func =</span> pk_delay, </span>
<span id="cb9-44"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-44" tabindex="-1"></a>               <span class="at">parms =</span> params_pk,</span>
<span id="cb9-45"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-45" tabindex="-1"></a>               <span class="at">events =</span> <span class="fu">list</span>(<span class="at">data =</span> dose_events))</span>
<span id="cb9-46"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-46" tabindex="-1"></a></span>
<span id="cb9-47"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-47" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb9-48"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-48" tabindex="-1"></a>df_pk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sol_pk)</span>
<span id="cb9-49"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-49" tabindex="-1"></a><span class="fu">colnames</span>(df_pk) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb9-50"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-50" tabindex="-1"></a></span>
<span id="cb9-51"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-51" tabindex="-1"></a>pk_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_pk, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> C)) <span class="sc">+</span></span>
<span id="cb9-52"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-52" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb9-53"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-53" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-54"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-54" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">65</span>, <span class="at">y =</span> <span class="fl">1.6</span>, <span class="at">label =</span> <span class="st">&quot;Therapeutic Upper Limit&quot;</span>, <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-55"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-55" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Drug Concentration with Absorption Delay&quot;</span>,</span>
<span id="cb9-56"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-56" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Rigorous event-based dosing simulation&quot;</span>,</span>
<span id="cb9-57"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-57" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time (hours)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Concentration (mg/L)&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-58"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-58" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-59"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-59" tabindex="-1"></a></span>
<span id="cb9-60"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb9-60" tabindex="-1"></a><span class="fu">print</span>(pk_plot)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>By using event-based dosing, we ensure that every milligram of the drug is accounted for, regardless of the solver’s step size. The delay <span class="math inline">\(\tau\)</span> shifts the peak concentration relative to the dosing time, a critical factor in determining whether a drug stays within its therapeutic window.</p>
</div>
<div id="immunological-memory-and-delayed-response" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">10.7</span> Immunological Memory and Delayed Response<a href="memory-matters-introduction-to-delay-differential-equations.html#immunological-memory-and-delayed-response" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The immune system embodies biological memory. A simplified model of viral infection with delayed immune response can be written as:</p>
<p><span class="math display">\[\frac{dV}{dt} = rV(t)\left(1 - \frac{V(t)}{K}\right) - pV(t)E(t)\]</span>
<span class="math display">\[\frac{dE}{dt} = cV(t-\tau) - \delta E(t)\]</span></p>
<p>Here, <span class="math inline">\(V(t)\)</span> represents viral load and <span class="math inline">\(E(t)\)</span> denotes effector immune cells. The term <span class="math inline">\(cV(t-\tau)\)</span> implies that the production of immune cells today depends on the viral load detected <span class="math inline">\(\tau\)</span> days ago (the time required for clonal expansion).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-1" tabindex="-1"></a><span class="co"># Viral infection with delayed immune response</span></span>
<span id="cb10-2"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-2" tabindex="-1"></a>viral_immune <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb10-3"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-3" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb10-4"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-4" tabindex="-1"></a>    </span>
<span id="cb10-5"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-5" tabindex="-1"></a>    <span class="cf">if</span> (t <span class="sc">&lt;=</span> tau) {</span>
<span id="cb10-6"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-6" tabindex="-1"></a>      lag_V <span class="ot">&lt;-</span> V0 <span class="co"># Initial history</span></span>
<span id="cb10-7"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-7" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb10-8"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-8" tabindex="-1"></a>      lag_state <span class="ot">&lt;-</span> <span class="fu">lagvalue</span>(t <span class="sc">-</span> tau)</span>
<span id="cb10-9"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-9" tabindex="-1"></a>      lag_V <span class="ot">&lt;-</span> lag_state[<span class="dv">1</span>]</span>
<span id="cb10-10"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-10" tabindex="-1"></a>    }</span>
<span id="cb10-11"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-11" tabindex="-1"></a>    </span>
<span id="cb10-12"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-12" tabindex="-1"></a>    <span class="co"># Viral dynamics (Logistic growth - predation)</span></span>
<span id="cb10-13"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-13" tabindex="-1"></a>    dV <span class="ot">&lt;-</span> r <span class="sc">*</span> V <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> V<span class="sc">/</span>K) <span class="sc">-</span> p <span class="sc">*</span> V <span class="sc">*</span> E</span>
<span id="cb10-14"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-14" tabindex="-1"></a>    </span>
<span id="cb10-15"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-15" tabindex="-1"></a>    <span class="co"># Immune response dynamics (Delayed recruitment)</span></span>
<span id="cb10-16"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-16" tabindex="-1"></a>    dE <span class="ot">&lt;-</span> c <span class="sc">*</span> lag_V <span class="sc">-</span> delta <span class="sc">*</span> E</span>
<span id="cb10-17"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-17" tabindex="-1"></a>    </span>
<span id="cb10-18"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-18" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">c</span>(dV, dE))</span>
<span id="cb10-19"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-19" tabindex="-1"></a>  })</span>
<span id="cb10-20"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-20" tabindex="-1"></a>}</span>
<span id="cb10-21"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-21" tabindex="-1"></a></span>
<span id="cb10-22"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-22" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb10-23"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-23" tabindex="-1"></a>params_immune <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb10-24"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-24" tabindex="-1"></a>  <span class="at">r =</span> <span class="fl">0.5</span>, <span class="at">K =</span> <span class="dv">1000</span>, <span class="at">p =</span> <span class="fl">0.01</span>, </span>
<span id="cb10-25"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-25" tabindex="-1"></a>  <span class="at">c =</span> <span class="fl">0.1</span>, <span class="at">delta =</span> <span class="fl">0.2</span>, <span class="at">tau =</span> <span class="dv">5</span>,</span>
<span id="cb10-26"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-26" tabindex="-1"></a>  <span class="at">V0 =</span> <span class="dv">100</span>, <span class="at">E0 =</span> <span class="dv">5</span></span>
<span id="cb10-27"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-27" tabindex="-1"></a>)</span>
<span id="cb10-28"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-28" tabindex="-1"></a></span>
<span id="cb10-29"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-29" tabindex="-1"></a>initial_immune <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">V =</span> params_immune<span class="sc">$</span>V0, <span class="at">E =</span> params_immune<span class="sc">$</span>E0)</span>
<span id="cb10-30"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-30" tabindex="-1"></a>times_immune <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb10-31"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-31" tabindex="-1"></a></span>
<span id="cb10-32"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-32" tabindex="-1"></a>sol_immune <span class="ot">&lt;-</span> <span class="fu">dede</span>(<span class="at">y =</span> initial_immune, </span>
<span id="cb10-33"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-33" tabindex="-1"></a>                   <span class="at">times =</span> times_immune,</span>
<span id="cb10-34"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-34" tabindex="-1"></a>                   <span class="at">func =</span> viral_immune, </span>
<span id="cb10-35"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-35" tabindex="-1"></a>                   <span class="at">parms =</span> params_immune)</span>
<span id="cb10-36"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-36" tabindex="-1"></a></span>
<span id="cb10-37"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-37" tabindex="-1"></a>df_immune <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sol_immune)</span>
<span id="cb10-38"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-38" tabindex="-1"></a><span class="fu">colnames</span>(df_immune) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;E&quot;</span>)</span>
<span id="cb10-39"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-39" tabindex="-1"></a></span>
<span id="cb10-40"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-40" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb10-41"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-41" tabindex="-1"></a>df_immune_long <span class="ot">&lt;-</span> df_immune <span class="sc">%&gt;%</span></span>
<span id="cb10-42"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-42" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(V, E), <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb10-43"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-43" tabindex="-1"></a></span>
<span id="cb10-44"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-44" tabindex="-1"></a>immune_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_immune_long, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, <span class="at">color =</span> variable)) <span class="sc">+</span></span>
<span id="cb10-45"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-45" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-46"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-46" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-47"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-47" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Chronic Viral Infection Dynamics&quot;</span>,</span>
<span id="cb10-48"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-48" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Oscillations driven by 5-day immune delay&quot;</span>,</span>
<span id="cb10-49"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-49" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time (days)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-50"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-50" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb10-51"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-51" tabindex="-1"></a></span>
<span id="cb10-52"><a href="memory-matters-introduction-to-delay-differential-equations.html#cb10-52" tabindex="-1"></a><span class="fu">print</span>(immune_plot)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The oscillatory dynamics reflect the chase between viral replication and immune control. Viral load peaks trigger immune responses that arrive too late to prevent overshoot, leading to excessive immune activity that suppresses viral load below equilibrium.</p>
</div>
<div id="connecting-past-and-future" class="section level2 hasAnchor" number="10.8">
<h2><span class="header-section-number">10.8</span> Connecting Past and Future<a href="memory-matters-introduction-to-delay-differential-equations.html#connecting-past-and-future" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Time delays force us to confront the role of history in shaping future dynamics. Systems with memory cannot be understood by examining their current state alone—we must know where they’ve been to predict where they’re going. This requirement transforms both our mathematical tools and our conceptual frameworks for understanding complex systems.</p>
<p>The techniques we’ve explored—characteristic equations for stability analysis, numerical integration respecting delay structures, and event-based handling of discontinuities—provide foundations for analyzing systems where time matters intrinsically. From disease outbreaks to drug responses to immunological dynamics, delay differential equations capture the temporal structures that ordinary differential equations miss, revealing oscillations, instabilities, and complex behaviors that arise specifically from memory effects.</p>
<p>As we continue exploring dynamical systems, the infinite-dimensional perspective opened by delay equations prepares us for further generalizations: partial differential equations where space and time intertwine, stochastic systems where randomness shapes evolution, and network dynamics where delays govern interactions across populations. The conceptual leap from instantaneous response to delayed feedback represents not merely technical sophistication but fundamental recognition that time itself—not just change over time—structures the systems we seek to understand.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spirals-cycles-and-chaos-complex-behaviors-in-2d-systems.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/Kamran-Afzali/Systems-Dynamics/edit/main/09-memory.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Kamran-Afzali/Systems-Dynamics/blob/main/09-memory.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
